# 画像アップローダーアプリケーション仕様書

## 概要
シンプルな画像アップローダーアプリケーションを開発する。ユーザーは画像をアップロードし、コメントを追加できる。また、LLM（Large Language Model）と連携し、画像とコメントをプロンプトとしてLLMに送信して応答を得ることができる。

## 機能要件
1. **画像アップロード機能**
   - ユーザーは画像ファイルをアップロードできる。
   - サポートする画像形式: JPEG, PNG, GIF。
   - アップロードされた画像はサーバーに保存される。
   - アップロード成功時に確認メッセージを表示。

2. **コメント追加機能**
   - 画像アップロード時にコメントを入力できる。
   - コメントはテキストフィールドで入力。
   - コメントは画像と関連付けて保存。

3. **AI生成機能**
   - アップロードされた画像とコメントをプロンプトとしてマルチモーダルモデルに送信。
   - ボタンを押すとAIから画像レスポンスを取得。
   - 生成された画像を表示。
   - AIとしてマルチモーダル対応モデルを使用（APIキーが必要）。

4. **画像表示機能**
   - アップロードされた画像を一覧表示。
   - 各画像にコメントを表示。
   - AI生成画像を表示。

5. **画像削除機能**
   - 各画像に削除ボタンを表示。
   - 削除確認ダイアログを表示。
   - 削除時に画像ファイルとデータベースエントリを削除。

6. **データベースリセット機能**
   - データベースとアップロードファイルをリセット。
   - リセット確認ダイアログを表示。
   - すべてのデータを削除して初期状態に戻す。

## 非機能要件
- **パフォーマンス**: 画像アップロードは5秒以内に完了。
- **セキュリティ**: アップロードされた画像は適切に検証（ファイルタイプ、サイズ制限）。
- **ユーザビリティ**: シンプルで直感的なUI。
- **拡張性**: モジュール化された設計で将来の機能追加を容易に。

## システムアーキテクチャ
- **フロントエンド**: HTML, CSS, JavaScript (シンプルなSPA)。
- **バックエンド**: Python (FlaskまたはFastAPI)。
- **データベース**: SQLite (シンプルなデータ保存用)。
- **LLM統合**: OpenAI API。
- **ファイルストレージ**: ローカルファイルシステム。

## API仕様
1. **POST /upload**
   - 画像とコメントをアップロード。
   - リクエスト: multipart/form-data (image, comment)。
   - レスポンス: 成功/失敗メッセージ。

2. **POST /generate**
   - 画像とコメントをプロンプトとしてAIに送信。
   - リクエスト: JSON (image_path, comment)。
   - レスポンス: 生成された画像のURLまたはデータ。

3. **GET /images**
   - アップロードされた画像一覧を取得。
   - レスポンス: JSON配列 (image_path, comment, ai_generated_image)。

4. **DELETE /delete/<filename>**
   - 指定された画像を削除。
   - リクエスト: DELETEメソッド。
   - レスポンス: 成功/失敗メッセージ。

## UI/UX仕様
- **メイン画面**: 画像アップロードフォーム、画像一覧。
- **アップロードフォーム**: ファイル選択、コメント入力、アップロードボタン。
- **画像一覧**: サムネイル表示、コメント表示、AI生成ボタン、削除ボタン。
- **AI生成画像**: 生成された画像をインラインで表示。

## 技術スタック
- **バックエンド**: Python 3.8+, Flask/FastAPI。
- **フロントエンド**: HTML5, CSS3, JavaScript (Vanilla JS or jQuery)。
- **AI**: OpenAI DALL-E 3 または類似のマルチモーダルモデル (gpt-4-vision-preview + DALL-E)。
- **データベース**: SQLite。
- **その他**: Pillow (画像処理), requests (API呼び出し)。

## 開発プロセス
1. 仕様書作成 (完了)。
2. プロジェクト構造作成。
3. バックエンド開発 (API実装)。
4. フロントエンド開発 (UI実装)。
5. LLM統合。
6. テストとデバッグ。
7. デプロイ準備。

## リスクと考慮事項
- OpenAI APIの使用制限とコスト（特に画像生成は高コスト）。
- 画像ファイルのセキュリティ（悪意あるファイルのアップロード防止）。
- プライバシー: アップロードされた画像とコメントの扱い。
- AI生成画像の品質と適切性。
- 画像生成の処理時間。
